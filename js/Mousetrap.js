(function(){function t(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)}function z(a){return"keypress"==a.type?String.fromCharCode(a.which):f[a.which]?f[a.which]:A[a.which]?A[a.which]:String.fromCharCode(a.which).toLowerCase()}function u(a,b){a=a||{};var c=!1,d;for(d in m)a[d]&&m[d]>b?c=!0:m[d]=0;c||(n=!1)}function B(a,b,c,d,h){var g,e,C=[],k=c.type;if(!l[a])return[];"keyup"==k&&v(a)&&(b=[a]);for(g=0;g<l[a].length;++g)if(e=l[a][g],(!e.seq||m[e.seq]==e.level)&&k==e.action){var f;
(f="keypress"==k&&!c.metaKey&&!c.ctrlKey)||(f=e.modifiers,f=b.sort().join(",")===f.sort().join(","));f&&(d&&e.combo==h&&l[a].splice(g,1),C.push(e))}return C}function w(a,b,c){p.stopCallback(b,b.target||b.srcElement,c)||!1!==a(b,c)||(b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation(),b.returnValue=!1,b.cancelBubble=!0)}function x(a){"number"!==typeof a.which&&(a.which=a.keyCode);var b=z(a);if(b)if("keyup"==a.type&&y==b)y=!1;else{var c=[];a.shiftKey&&c.push("shift");a.altKey&&
c.push("alt");a.ctrlKey&&c.push("ctrl");a.metaKey&&c.push("meta");var c=B(b,c,a),d,f={},g=0,e=!1;for(d=0;d<c.length;++d)c[d].seq?(e=!0,g=Math.max(g,c[d].level),f[c[d].seq]=1,w(c[d].callback,a,c[d].combo)):e||n||w(c[d].callback,a,c[d].combo);a.type!=n||v(b)||u(f,g)}}function v(a){return"shift"==a||"ctrl"==a||"alt"==a||"meta"==a}function D(a,b,c){if(!c){if(!q){q={};for(var d in f)95<d&&112>d||f.hasOwnProperty(d)&&(q[f[d]]=d)}c=q[a]?"keydown":"keypress"}"keypress"==c&&b.length&&(c="keydown");return c}
function I(a,b,c,d){m[a]=0;d||(d=D(b[0],[]));var f=function(b){n=d;++m[a];clearTimeout(E);E=setTimeout(u,1E3)},g=function(b){w(c,b,a);"keyup"!==d&&(y=z(b));setTimeout(u,10)},e;for(e=0;e<b.length;++e)F(b[e],e<b.length-1?f:g,d,a,e)}function F(a,b,c,d,f){r[a+":"+c]=b;a=a.replace(/\s+/g," ");var g=a.split(" "),e,h,k=[];if(1<g.length)I(a,g,b,c);else{h="+"===a?["+"]:a.split("+");for(g=0;g<h.length;++g)e=h[g],G[e]&&(e=G[e]),c&&"keypress"!=c&&H[e]&&(e=H[e],k.push("shift")),v(e)&&k.push(e);c=D(e,k,c);l[e]||
(l[e]=[]);B(e,k,{type:c},!d,a);l[e][d?"unshift":"push"]({callback:b,modifiers:k,action:c,seq:d,level:f,combo:a})}}for(var f={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},A={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},H={"~":"`","!":"1",
"@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},G={option:"alt",command:"meta","return":"enter",escape:"esc"},q,l={},r={},m={},E,y=!1,n=!1,h=1;20>h;++h)f[111+h]="f"+h;for(h=0;9>=h;++h)f[h+96]=h;t(document,"keypress",x);t(document,"keydown",x);t(document,"keyup",x);var p={bind:function(a,b,c){a=a instanceof Array?a:[a];for(var d=0;d<a.length;++d)F(a[d],b,c);return this},unbind:function(a,b){return p.bind(a,function(){},
b)},trigger:function(a,b){if(r[a+":"+b])r[a+":"+b]();return this},reset:function(){l={};r={};return this},stopCallback:function(a,b,c){return-1<(" "+b.className+" ").indexOf(" mousetrap ")?!1:"INPUT"==b.tagName||"SELECT"==b.tagName||"TEXTAREA"==b.tagName||b.contentEditable&&"true"==b.contentEditable}};window.Mousetrap=p;"function"===typeof define&&define.amd&&define(p)})();